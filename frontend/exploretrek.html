<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Explore Trek - Girivan Hikes</title>
    <style>
        /* General Styles */
body {
    font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 0;
            background-image: url('https://images.unsplash.com/photo-1569001852726-323fd51b26f3?fm=jpg&q=60&w=3000&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTV8fGZvcnRzfGVufDB8fDB8fHww'); 
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            background-repeat: no-repeat;
            padding-top: 20px; /* Adjust based on navbar height */
            margin-bottom: 3px;
}
body::before {
    content: "";
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    backdrop-filter: blur(0px);
    z-index: -1;
}

  /* Navbar */
  nav {
    position: fixed; /* Makes the navbar fixed */
    top: 0; /* Sticks it to the top */
    left: 0;
    width: 100%;
    background: rgba(0, 0, 0, 0.7); /* Ensures transparency */
    color: white;
    display: flex;
    align-items: center;
    padding: 15px 50px;
    z-index: 1000; /* Ensures it stays above other content */
    box-shadow: 0px 5px 10px rgba(0, 0, 0, 0.3);
}

  nav ul {
      list-style: none;
      display: flex;
      gap: 20px;
      padding: 0;
margin: 0 auto ;
  }

  nav ul li {
    display: inline-block;
  }

  nav ul li a {
      color: white;
      text-decoration: none;
      font-weight: bold;
  }

header {
    
    text-align: center;
    padding: 1.5rem;
    font-size: 24px;
    font-weight: 600;
 
}

 /* Hero Section */
 @keyframes fadeSlideIn {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.hero {
    margin-bottom: 0;
    padding-bottom: 10px; /* Adjust padding */

    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 40vh;
    color: white;
    text-align: center;
    padding: 10px;
    min-height: 60vh;
    position: relative;
    margin-top: -50px;
    margin-bottom: 0;  /* Remove extra margin */
    padding-bottom: 20px; /* Adjust padding */
    background-color: transparent;
}

.hero h3 {
    font-size: 2.4rem;
    margin-bottom: 10px; /* Reduce this */
    margin-bottom: 0px;
    animation: fadeSlideIn 1.5s ease-out;
}
.hero p {
    margin-bottom: 1px; /* Reduce this */
    animation: fadeSlideIn 2s ease-out;
}

/* Sections */
.card {
    
    width: 90%;
    max-width: 800px;
    background: #ffffff;
    color: #333;
    margin: 20px auto;
    padding: 20px;
    margin-top: -100px;
    border-radius: 12px;
    box-shadow: 0px 5px 15px rgba(0, 0, 0, 0.2);
}

/* Form */
/* General Form Styling */
form {
    display: flex;
    flex-direction: column;
    gap: 15px;
    padding: 20px;
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    max-width: 600px;
    margin: auto;
}

/* Form Groups */
.form-group {
    display: flex;
    flex-direction: column;
    gap: 5px;
}

/* Two-Column Layout */
.form-row {
    display: flex;
    gap: 15px;
}

.form-row .form-group {
    flex: 1;
}

/* Input & Select Fields */
input, select, textarea {
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 8px;
    font-size: 14px;
    transition: 0.3s;
}

input:focus, select:focus, textarea:focus {
    border-color: #4ca1af;
    outline: none;
    box-shadow: 0px 0px 5px rgba(76, 161, 175, 0.8);
}

/* Button Styling */
button {
    background: #4ca1af;
    color: white;
    font-size: 18px;
    cursor: pointer;
    border: none;
    padding: 12px;
    border-radius: 8px;
    transition: 0.3s;
}

button:hover {
    background: #2c3e50;
}

/* Responsive Design */
@media (max-width: 600px) {
    .form-row {
        flex-direction: column;
    }
}


/* Trek Listings */
#trek-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 15px;
}

.trek-card {
    background: white;
    color: #333;
    padding: 15px;
    border-radius: 10px;
    box-shadow: 0px 5px 10px rgba(0, 0, 0, 0.1);
    width: 300px;
    transition: transform 0.3s;
}

.trek-card:hover {
    transform: translateY(-5px);
}

.trek-card img {
    width: 100%;
    border-radius: 8px;
}

    </style>
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
</head>
<body>
     <!-- Navigation Bar -->
     <nav>
        <h1>Explore Trek </h1>
        <ul>
            <li><a href="index.html">Home &emsp;</a></li>
            <li><a href="exploreguide.html">Explore Guide &emsp;</a></li>
            <li><a href="exploretrek.html">Explore Treks</a></li>
            <li><a href="upcomingtrek.html">Upcoming Treks</a></li>
            <li><a href="map.html">Descover Map &emsp;</a></li>
            <li><a href="faq.html">FAQs</a></li>
        </ul>
    </nav>

    <!-- Hero Section -->
    <header class="hero">
        <h3>Discover, Share & Explore New Trails!</h3>
        <p>Plan your next adventure or help others start theirs! Upload your trek schedules or explore exciting upcoming treks.</p>
    </header>

    <section id="guide-dashboard" class="card">
        <h2>üìÖ Upload Trek Schedule</h2>
     <!-- Message for everyone -->
    <p style="color: red; font-weight: bold; text-align: center;">
        Only guides can upload trek schedules.
    </p>
        <form id="trek-form">
            <div class="form-group">
                <label for="title">üèîÔ∏è Trek Title</label>
                <input type="text" id="title" required>
            </div>

            <div class="form-group">
                <label for="location">Location</label>
                <input type="text" id="location" required>
            </div>
    
            <div class="form-row">
                <div class="form-group">
                    <label for="date">üìÖ Trek Date</label>
                    <input type="date" id="date" required>
                </div>
                <div class="form-group">
                    <label for="difficulty">üî• Difficulty</label>
                    <select id="difficulty">
                        <option value="Easy">üü¢ Easy</option>
                        <option value="Moderate">üü° Moderate</option>
                        <option value="Difficult">üî¥ Difficult</option>
                    </select>
                </div>
            </div>
    
            <div class="form-row">
                <div class="form-group">
                    <label for="duration">‚è≥ Duration</label>
                    <input type="text" id="duration" placeholder="e.g. 2 days" required>
                </div>
                <div class="form-group">
                    <label for="altitude">‚õ∞Ô∏è Highest Altitude</label>
                    <input type="text" id="altitude" placeholder="e.g. 4000m" required>
                </div>
            </div>
    
            <div class="form-group">
                <label for="base-camp">üèïÔ∏è Base Camp</label>
                <input type="text" id="base-camp" required>
            </div>
    
            <div class="form-group">
                <label for="fees">üí∞ Fees (‚Çπ)</label>
                <input type="number" id="fees" required>
            </div>
    
            <div class="form-group">
                <label for="transport">üöó Transport (Optional)</label>
                <input type="text" id="transport">
            </div>
    
            <div class="form-group">
                <label for="things-to-carry">üéí Things to Carry</label>
                <textarea id="things-to-carry" required></textarea>
            </div>
    
            <div class="form-row">
                <div class="form-group">
                    <label for="guide-name">üë®‚Äçüíº Guide Name</label>
                    <input type="text" id="guide-name" required>
                </div>
                <div class="form-group">
                    <label for="contact">üìû Contact</label>
                    <input type="tel" id="contact" required>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="guide-email">üìß Guide Email</label>
                    <input type="email" id="email" required placeholder="Enter your registered guide email">
                </div>
                <div class="form-group">
                    <label for="instagram">Give whatsApp or instagram link</label>
                    <input type="url" id="instagram">
                </div>
            </div>

    
            <button type="submit">üöÄ Upload Trek</button>
        </form>
    </section>
    
    
    <section id="trek-listings" class="card">
        <h2>üåç Available Treks</h2>
        <div class="search-filter">
            <input type="text" id="search" placeholder="üîç Search by title or location">
            <select id="filter-difficulty">
                <option value="">All Difficulties</option>
                <option value="Easy">üü¢ Easy</option>
                <option value="Moderate">üü° Moderate</option>
                <option value="Difficult">üî¥ Difficult</option>
            </select>
        </div>
        <div id="trek-container"></div>

    </section>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.3.1/firebase-app.js";
        import { getFirestore, collection, getDocs, addDoc, query, where } from "https://www.gstatic.com/firebasejs/11.3.1/firebase-firestore.js";
    
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-analytics.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries
      
        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
          apiKey: "AIzaSyDeMnajXmDStMpihzxuYUikzz5oilFw_2c",
          authDomain: "girivan-hikes.firebaseapp.com",
          databaseURL: "https://girivan-hikes-default-rtdb.firebaseio.com",
          projectId: "girivan-hikes",
          storageBucket: "girivan-hikes.firebasestorage.app",
          messagingSenderId: "51100764191",
          appId: "1:51100764191:web:4fc2e80b36afecb295ad2a",
          measurementId: "G-RWSFVY9KTW"
        };
      
        // Initialize Firebase
        const analytics = getAnalytics(app);
    
        // ‚úÖ Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
    
        document.addEventListener("DOMContentLoaded", async () => {
            const trekContainer = document.getElementById("trek-container");
            const searchInput = document.getElementById("search");
            const filterDifficulty = document.getElementById("filter-difficulty");
            const trekForm = document.getElementById("trek-form");
    
            // ‚úÖ Function to Check if Guide Email Exists
            async function isGuideRegistered(email) {
                try {
                    console.log("üîç Checking guide registration for:", email);
                    const q = query(collection(db, "guideEmail"), where("email", "==", email));
                    const querySnapshot = await getDocs(q);
                    return !querySnapshot.empty;  // ‚úÖ Returns true if email exists, false otherwise
                } catch (error) {
                    console.error("‚ùå Error checking guide registration:", error);
                    return false;
                }
            }
    
            // ‚úÖ Function to Upload Trek Data
            async function uploadTrek(trekData) {
                try {
                    await addDoc(collection(db, "treks"), trekData);
                    alert("üéâ Trek uploaded successfully!");
                    trekForm.reset();
                    fetchTreks();  // ‚úÖ Refresh trek list after upload
                } catch (error) {
                    console.error("‚ùå Error uploading trek:", error.message);
                    alert("‚ùå Failed to upload trek. Error: " + error.message);
                }
            }
    
            // ‚úÖ Handle Form Submission
            trekForm.addEventListener("submit", async function (event) {
                event.preventDefault();
    
                const guideEmail = document.getElementById("email").value.trim().toLowerCase();
    
                if (!guideEmail) {
                    alert("‚ö†Ô∏è Please enter a guide email.");
                    return;
                }
    
                // ‚úÖ Check if guide is registered
                const isRegistered = await isGuideRegistered(guideEmail);
    
                if (!isRegistered) {
                    alert("üö´ Your email is not registered as a guide. Please check your email.");
                    return;
                }
    
                // ‚úÖ Collect Trek Data
                const trekData = {
                    title: document.getElementById("title").value.trim(),
                    location: document.getElementById("location").value.trim(),
                    date: document.getElementById("date").value,
                    difficulty: document.getElementById("difficulty").value,
                    duration: document.getElementById("duration").value.trim(),
                    baseCamp: document.getElementById("base-camp").value.trim(),
                    altitude: document.getElementById("altitude").value.trim(),
                    fees: document.getElementById("fees").value.trim(),
                    transport: document.getElementById("transport").value.trim() || "Not provided",
                    guideName: document.getElementById("guide-name").value.trim(),
                    contact: document.getElementById("contact").value.trim(),
                    email: guideEmail,
                    instagram: document.getElementById("instagram").value.trim() || "Not provided",
                    thingsToCarry: document.getElementById("things-to-carry").value.trim(),
                    createdAt: new Date()  // ‚úÖ Timestamp
                };
    
                // ‚úÖ Upload Trek
                uploadTrek(trekData);
            });
    
            // ‚úÖ Function to Fetch and Display Treks
            async function fetchTreks() {
                trekContainer.innerHTML = ""; // Clear existing content
                const querySnapshot = await getDocs(collection(db, "treks"));
                const treks = querySnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                displayTreks(treks);
            }
    
            // ‚úÖ Function to Display Treks
            function displayTreks(treks) {
                trekContainer.innerHTML = ""; // Clear old results
                if (treks.length === 0) {
                    trekContainer.innerHTML = "<p>No treks found.</p>";
                    return;
                }
                treks.forEach(trek => {
                    const trekCard = document.createElement("div");
                    trekCard.classList.add("trek-card");
                    trekCard.innerHTML = `
                        <h3>${trek.title}</h3>
                        <p><strong>üìç Location:</strong> ${trek.location}</p>
                        <p><strong>üìÖ Date:</strong> ${trek.date}</p>
                        <p><strong>üî• Difficulty:</strong> ${trek.difficulty}</p>
                        <p><strong>‚è≥ Duration:</strong> ${trek.duration}</p>
                        <p><strong>üí∞ Fees:</strong> ‚Çπ${trek.fees}</p>
                        <p><strong>üë®‚Äçüíº Guide:</strong> ${trek.guideName} | üìû ${trek.contact}</p>
                    `;
                    trekContainer.appendChild(trekCard);
                });
            }
    
            // ‚úÖ Function to Filter Treks
            async function filterTreks() {
                const searchText = searchInput.value.toLowerCase();
                const selectedDifficulty = filterDifficulty.value;
    
                const querySnapshot = await getDocs(collection(db, "treks"));
                let filteredTreks = querySnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
    
                // Filter by search input (Location or Title)
                if (searchText) {
                    filteredTreks = filteredTreks.filter(trek =>
                        trek.title.toLowerCase().includes(searchText) ||
                        trek.location.toLowerCase().includes(searchText)
                    );
                }
    
                // Filter by difficulty
                if (selectedDifficulty) {
                    filteredTreks = filteredTreks.filter(trek => trek.difficulty === selectedDifficulty);
                }
    
                displayTreks(filteredTreks);
            }
    
            // ‚úÖ Event Listeners for Search & Filter
            searchInput.addEventListener("input", filterTreks);
            filterDifficulty.addEventListener("change", filterTreks);
    
            // ‚úÖ Initial Fetch
            fetchTreks();
        });
    </script>
            
</body>
</html>
